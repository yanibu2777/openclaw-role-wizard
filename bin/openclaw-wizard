#!/usr/bin/env node

const { Command } = require('commander');
const chalk = require('chalk');
const { runWizard } = require('../lib/wizard');
const { version } = require('../package.json');

const program = new Command();

program
  .name('openclaw-role-wizard')
  .description('Add role-specific templates and workflows to your OpenClaw workspace (~/clawd)')
  .version(version);

program
  .command('init')
  .description('Start the interactive onboarding wizard')
  .option('-t, --template <type>', 'Pre-select template type (founder|engineer|creator|student)')
  .option('--skip-checks', 'Skip system requirement checks')
  .action(async (options) => {
    try {
      console.log(chalk.blue('\nðŸ¦ž Welcome to OpenClaw Role-Based Setup Wizard!'));
      console.log('Transforming "now what?" into productive AI employee...\n');
      
      await runWizard(options);
    } catch (error) {
      console.error(chalk.red('âŒ Setup failed:'), error.message);
      process.exit(1);
    }
  });

program
  .command('test')
  .description('Test the wizard without making changes')
  .action(async () => {
    console.log(chalk.yellow('ðŸ§ª Running wizard in test mode...'));
    await runWizard({ testMode: true });
  });

// Default command when no args provided
if (process.argv.length === 2) {
  program.help();
}

program.parse();